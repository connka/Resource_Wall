<!DOCTYPE html>
<html lang="en">
        <head>

        </head>
<header>
        <% include partials/_header %> 
        <script src="/scripts/app.js"></script>
</header>
<body>
        <div id="filter_bar">
                <h1>Search Resources</h1>
        <div class=".col-sm-5 .col-md-9">
                        <div class="input-group">
                        <input id="search-bar" type="text" class="form-control" placeholder="Search for...">
                        <span class="input-group-btn">
                        <button class="btn btn-default my_toggle" type="button">Search</button>
                        </span>
                        </div>
                </div>
                <div class="interest_id_select">
                                <select class="interest_id" name="intrest_id">
                                <option selected>--Resource Category--</option>
                                <option value="1">Sports</option>
                                <option value="2">Web Development</option>
                                <option value="3">Food</option>
                                <option value="4">Reading</option>
                                <option value="5">Travelling</option>
                                <option value="6">Fishing</option>
                        <option value="7">Crafts</option>
                        <option value="8">Movies</option>
                                <option value="9">Music</option>
                        <option value="10">Gardening</option>
                        <option value="11">Games</option>
                        <option value="12">Hunting</option>
                        <option value="13">Restaurants</option>
                                <option value="14">Cars</option>
                                </select>
                                </select>
                                </div>
                        </div>
                        <br />

    <%for(let resource in allResources){%>
    <div class="resourse_archive">
        <% let avgRating = resource.totalRating/resource.countRating %>
        <div class="submitted_by">Submitted by: <%= allResources[resource].user_id%></div>
      <h2 id="resourse_name" class="resourse_name"> 
        <a href=<%= allResources[resource].url %>> <%= allResources[resource].title %> </a></h2>
        <p id="description">Description: <%= allResources[resource].description %></p>
      <ul id="intrest">Category: <%= allResources[resource].intrest_id %></ul>
      <ul id="like">Likes: <%= allResources[resource].totalLikes %></ul>
      <ul id="avgRating"> Rating: <%= allResources[resource].avgRating() || 0 %></ul>
      <% if (user_id) { %>
      <button class="comment_toggle">Give feedback on this resource</button>
      <% } %>
</div>


        <div hidden class="comment_dropdown">
                <button class="likebtn" method="POST" action="<%= user_id%>/resourses/<%= allResources[resource].resourse_id%>/like%>">I like this resource!</button><br>
                <div class="col-md-2">
                                <div class="resourse_rating">
                                                <select class="user_resourse_rating" name="user_resourse_rating">
                                                        <option selected>--Resource Rating--</option>
                                                        <option value="1">1</option>
                                                        <option value="2">2</option>
                                                        <option value="3">3</option>
                                                        <option value="4">4</option>
                                                        <option value="5">5</option>
                                                </select>
                                </div>
                </div>

        <form method="POST" action="/api/users/<%= user_id%>/resourses/<%= allResources[resource].resourse_id%>/comment" class="comment_box">
        Comment on this resource:

          <label for="new_comment"></label>
          <textarea
            class="form-control z-depth-1" 
            id="new_comment"
            rows="2"
            name='text'></textarea>
            <input type="submit" value="Submit">

            </form>
            <hr>
      <div id="previous_comments"></div> <h3>Comments: </h3>
      <%for(let comment of allResources[resource].comments){%>
        <p><%= comment.username%> @ <%= comment.updated_at%>: 
        <ul><%= comment.text%></ul>
        <%}%>
</div>
</div>
<hr>
        <%}%>

</body>
</html>